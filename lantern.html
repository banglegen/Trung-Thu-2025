<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trung Thu 3D</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Brush+Script+MT&display=swap');

    :root{
      --bg:#0b1020;
      --moon:#fffae1;
      --lantern-main:#ff0000;
      --lantern-accent:#ffd88a;
      --glow:0 0 30px rgba(255,170,120,0.12),0 6px 40px rgba(0,0,0,0.6);
      --font:'Inter',system-ui;
    }
    html,body{height:100%;margin:0;font-family:var(--font);background:linear-gradient(180deg,var(--bg) 0%,#071025 70%);overflow:hidden;color:#fff}
    .scene{width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;perspective:1200px;position:relative;user-select:none}
    canvas#stars{position:absolute;inset:0;z-index:0}
    .moon-wrap{position:absolute;top:8vh;right:8vw;transform-style:preserve-3d;z-index:2}
    .moon{width:170px;height:170px;border-radius:50%;background:radial-gradient(circle at 30% 25%,#fff 0%,var(--moon) 30%,#ffd 55%,#f1e6cf 70%,rgba(241,230,207,0.6));box-shadow:0 0 60px rgba(255,250,205,0.14),inset -14px -8px 30px rgba(0,0,0,0.08);transform:translateZ(200px) rotateX(10deg)}
    .horizon{position:absolute;bottom:0;left:0;right:0;height:28vh;background:linear-gradient(180deg,transparent,#021017 60%,#02060b 100%);z-index:2}
    .trees{position:absolute;left:6vw;bottom:2vh;display:flex;gap:10px;transform:translateZ(80px)}
    .tree{width:60px;height:120px;background:linear-gradient(180deg,#052218,#02160f);clip-path:polygon(50% 0,70% 30%,58% 30%,80% 55%,60% 55%,78% 100%,50% 75%,22% 100%,40% 55%,20% 55%,42% 30%,30% 30%);opacity:.9}
    .lanterns{position:relative;z-index:3;transform-style:preserve-3d}
    .lantern{width:140px;height:220px;position:absolute;left:50%;top:50%;transform-style:preserve-3d;transform:translate3d(-50%,-50%,0) rotateX(12deg);animation:float 8s ease-in-out infinite;will-change:transform}
    .lantern:hover{transform:translate3d(-50%,-50%,60px) rotateX(12deg) scale(1.06)}
    @keyframes float{0%{transform:translate3d(-50%,-50%,0) rotateX(12deg) translateY(-4px)}50%{transform:translate3d(-50%,-50%,8px) rotateX(10deg) translateY(6px)}100%{transform:translate3d(-50%,-50%,0) rotateX(12deg) translateY(-4px)}}
    .band{position:absolute;left:50%;width:120px;height:18px;background:linear-gradient(90deg,var(--lantern-accent),#ffd);transform:translateX(-50%);top:26%;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.35)}
    .band.bottom{top:62%}
    .tassel{position:absolute;left:50%;bottom:-36px;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:6px}
    .tassel .stick{width:6px;height:38px;background:linear-gradient(180deg,#2b100d,#6b250f);border-radius:3px}
    .tassel .strings{display:flex;gap:8px}
    .tassel .strings span{width:6px;height:34px;border-radius:4px;background:linear-gradient(180deg,#ff9d9d,#ff5b5b);transform-origin:top;animation:wag 3s ease-in-out infinite}
    .tassel .strings span:nth-child(2){animation-delay:.12s}
    .tassel .strings span:nth-child(3){animation-delay:.24s}
    @keyframes wag{0%{transform:rotate(0)}50%{transform:rotate(6deg)}100%{transform:rotate(0)}}
    .hud{position:absolute;left:18px;top:18px;z-index:6;background:rgba(0,0,0,0.25);backdrop-filter:blur(6px);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);color:#fff}
    .hud label{font-size:13px;opacity:.95}
    .hud input[type=color]{width:44px;height:36px;border:0;background:none;padding:0;margin-left:8px}
    .hud .range{width:140px}
    .credit{position:absolute;right:12px;bottom:12px;color:rgba(255,255,255,0.55);font-size:13px;z-index:6}
    .title{position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);font-family:'Brush Script MT',cursive;font-size:70px;color:#ffe8b3;text-shadow:0 0 20px rgba(255,255,200,0.4),0 0 40px rgba(255,240,200,0.2);z-index:5;white-space:nowrap}
  </style>
</head>
<body>
  <div class="scene" id="scene">
    <canvas id="stars"></canvas>
    <div class="moon-wrap"><div class="moon"></div></div>
    <div class="lanterns" id="lanterns"></div>
    <div class="title">Chúc Mừng Trung Thu</div>
    <div class="horizon"><div class="trees"><div class="tree"></div><div class="tree" style="transform:scale(.9)"></div><div class="tree" style="transform:scale(.8)"></div></div></div>
    <div class="hud">
      <div style="display:flex;gap:8px;align-items:center"><label for="color">Màu đèn</label><input id="color" type="color" value="#ff6b6b"></div>
      <div style="margin-top:8px;display:flex;gap:8px;align-items:center"><label for="size">Vòng ngoài</label><input id="size" class="range" type="range" min="60" max="160" value="90"></div>
      <div style="margin-top:8px;display:flex;gap:8px;align-items:center"><button id="addLantern">Thêm đèn</button><button id="clearLanterns">Xóa</button></div>
    </div>
    <div class="credit">Được làm bởi banglegen</div>
  </div>
  <script>
    function createLantern(xPct,yPct,zOffset,color,ringSize){
      const wrap=document.createElement('div');wrap.className='lantern';wrap.style.left=xPct+'%';wrap.style.top=yPct+'%';wrap.style.transform=`translate3d(-50%,-50%,${zOffset}px) rotateX(12deg)`;
      const bandTop=document.createElement('div');bandTop.className='band';wrap.appendChild(bandTop);
      const bandBot=document.createElement('div');bandBot.className='band bottom';wrap.appendChild(bandBot);
      const ring=document.createElement('div');ring.style.width=ringSize+'px';ring.style.height='160px';const faces=18;
      for(let i=0;i<faces;i++){const f=document.createElement('div');const angle=(360/faces)*i;f.style.position='absolute';f.style.left='50%';f.style.top='0';f.style.transformOrigin='0 50%';f.style.width=ringSize*0.65+'px';f.style.height=Math.max(120,ringSize*1.2)+'px';f.style.borderRadius='50px/80px';f.style.background=`linear-gradient(180deg,${color},rgba(0,0,0,0.12))`;f.style.boxShadow='var(--glow)';f.style.transform=`rotateY(${angle}deg) translateZ(${ringSize/2}px)`;ring.appendChild(f);}wrap.appendChild(ring);
      const tassel=document.createElement('div');tassel.className='tassel';tassel.innerHTML='<div class="stick"></div><div class="strings"><span></span><span></span><span></span></div>';wrap.appendChild(tassel);
      wrap.style.animationDelay=Math.random()*2+'s';return wrap;}
    const lanternsContainer=document.getElementById('lanterns');const colorInput=document.getElementById('color');const sizeRange=document.getElementById('size');const addBtn=document.getElementById('addLantern');const clearBtn=document.getElementById('clearLanterns');
    const initial=[{x:36,y:44,z:30},{x:62,y:52,z:10},{x:48,y:34,z:60}];initial.forEach(p=>{const l=createLantern(p.x,p.y,p.z,colorInput.value,parseInt(sizeRange.value));lanternsContainer.appendChild(l);});
    addBtn.onclick=()=>{const x=22+Math.random()*56;const y=26+Math.random()*54;const z=Math.random()*80-20;const l=createLantern(x,y,z,colorInput.value,parseInt(sizeRange.value));lanternsContainer.appendChild(l);}
    clearBtn.onclick=()=>{lanternsContainer.innerHTML=''}
    colorInput.addEventListener('input',()=>{const c=colorInput.value;document.documentElement.style.setProperty('--lantern-main',c);document.querySelectorAll('.lantern div').forEach(f=>{if(f.style.background)f.style.background=`linear-gradient(180deg,${c},rgba(0,0,0,0.12))`;});});
    sizeRange.addEventListener('input',()=>{const v=parseInt(sizeRange.value);document.querySelectorAll('.lantern div').forEach(f=>{if(f.style.width){f.style.width=v*0.65+'px';f.style.height=Math.max(120,v*1.2)+'px';}});});
    const canvas=document.getElementById('stars');const ctx=canvas.getContext('2d');function resize(){canvas.width=innerWidth*devicePixelRatio;canvas.height=innerHeight*devicePixelRatio;canvas.style.width=innerWidth+'px';canvas.style.height=innerHeight+'px';ctx.scale(devicePixelRatio,devicePixelRatio);drawStars();}window.addEventListener('resize',resize);
    let stars=[];function initStars(){stars=[];const count=Math.floor((innerWidth+innerHeight)/9);for(let i=0;i<count;i++){stars.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*1.6+0.2,alpha:Math.random()*0.9+0.1,twinkle:Math.random()*1.5});}}function drawStars(t){ctx.clearRect(0,0,canvas.width,canvas.height);stars.forEach((s,idx)=>{const a=s.alpha*(0.7+0.3*Math.sin((t/600)+idx*0.3*s.twinkle));ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fillStyle=`rgba(255,255,240,${a})`;ctx.fill();});}
    function animate(time){drawStars(time);const moon=document.querySelector('.moon');moon.style.transform=`translateZ(200px) rotate(${time/12000}deg) rotateX(8deg)`;requestAnimationFrame(animate);}initStars();resize();requestAnimationFrame(animate);
    window.addEventListener('keydown',e=>{if(e.key.toLowerCase()==='a')addBtn.click();if(e.key.toLowerCase()==='c')clearBtn.click();});
  </script>
</body>
</html>
